/*
* contra.js
* Ed Fuhrken
* https://github.com/edfuh/contra
* License MIT
*/
(function(s,F){var p=[],k,a=[38,38,40,40,37,39,37,39,66,65],j=0,r=!!("ontouchstart" in s),q=false,A,o,l,G,E,v="addEventListener",t="touches",i="length",c="button",n="appendChild",h="createElement",I,C,B;function H(){q=false;j=0;r&&D();}function u(){while(k=p.shift()){k();}}function x(w,d){!!F[v]?F[v](w,d,0):F.attachEvent("on"+w,d);}function z(d,w){while(d=d.parentNode){if(d===w){return true;}}return false;}function f(w){var d=w.which||w.keyCode;if(d===a[j]){j++;if(j>=a[i]){u();H();}}else{H();}}function m(J){J.preventDefault();l=o=G=E=0;var w=this.id.split("-")[1],d;if(w==="a"){d=65;}else{if(w==="b"){d=66;}}f({which:d});}function D(){I.className="contra-hidden";}function y(){if(typeof I==="undefined"){I=F[h]("div");C=F[h](c);B=F[h](c);I.id="contracode-controller";C.id="contracode-a";B.id="contracode-b";C.innerHTML="A";B.innerHTML="B";I.style.cssText=["position:absolute","top:0","left:0","right:0","bottom:0"].join(";");I[n](B);I[n](C);F.body[n](I);}I.className="contra-visible";}function e(d){if(d[t][i]){A=d[t][d[t][i]-1];o=0;l=0;G=A.pageX;E=A.pageY;}}function g(d){if(d[t][i]){A=d[t][d[t][i]-1];o=A.pageX;l=A.pageY;}}function b(L){if(q){var J=L.target,d=J===C||z(J,C)?C:J===B||z(J,B)?B:false;if(d){m.call(d,L);}else{H();}}else{var M=Math,Q=M.abs,K=o-G,O=l-E,P=Q(K),w=Q(O),N;if(M.max(P,w)===P){if(K>0){N=39;}else{N=37;}}else{if(O>0){N=40;}else{N=38;}}f({which:N});if(j===a[i]-2){q=true;y();}}}x("keyup",f);if(r){x("touchstart",e);x("touchmove",g);x("touchend",b);}s.contra=function(d){p.push(d);};}(this,document));