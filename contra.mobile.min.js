/*
* contra.js
* Ed Fuhrken
* https://github.com/edfuh/contra
* License MIT
*/
(function(t,G){var q=[],l,a=[38,38,40,40,37,39,37,39,66,65],k=0,s=!!("ontouchstart" in t),e=void 0,r=false,B,p,m,H,F,x="addEventListener",u="touches",j="length",c="button",o="appendChild",i="createElement",J,D,C;function I(){r=false;k=0;s&&E();}function v(){while(l=q.shift()){l();}}function y(w,d){!!G[x]?G[x](w,d,0):G.attachEvent("on"+w,d);}function A(d,w){while(d=d.parentNode){if(d===w){return true;}}return false;}function g(w){var d=w.which||w.keyCode;if(d===a[k]){k++;if(k>=a[j]){v();I();}}else{I();}}function n(K){K.preventDefault();m=p=H=F=0;var w=this.id.split("-")[1],d;if(w==="a"){d=65;}else{if(w==="b"){d=66;}}g({which:d});}function E(){if(J!==e){J.className="contra-hidden";}}function z(){if(J===e){J=G[i]("div");D=G[i](c);C=G[i](c);J.id="contracode-controller";D.id="contracode-a";C.id="contracode-b";D.innerHTML="A";C.innerHTML="B";J.style.cssText=["position:absolute","top:0","left:0","right:0","bottom:0"].join(";");J[o](C);J[o](D);G.body[o](J);}J.className="contra-visible";}function f(d){if(d[u][j]){B=d[u][d[u][j]-1];p=0;m=0;H=B.pageX;F=B.pageY;}}function h(d){if(d[u][j]){B=d[u][d[u][j]-1];p=B.pageX;m=B.pageY;}}function b(M){if(r){var K=M.target,d=K===D||A(K,D)?D:K===C||A(K,C)?C:false;if(d){n.call(d,M);}else{I();}}else{var N=Math,R=N.abs,L=p-H,P=m-F,Q=R(L),w=R(P),O;if(N.max(Q,w)===Q){if(L>0){O=39;}else{O=37;}}else{if(P>0){O=40;}else{O=38;}}g({which:O});if(k===a[j]-2){r=true;z();}}}y("keyup",g);if(s){y("touchstart",f);y("touchmove",h);y("touchend",b);}t.contra=function(d){q.push(d);};}(this,document));